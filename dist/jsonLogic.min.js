!(function(r,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):(r=r||self).jsonLogic=n()})(this,(function(){"use strict";var c=Array.isArray;function o(r){return"object"==typeof r&&null!==r&&!c(r)&&1===Object.keys(r).length}function f(r){return Object.keys(r)[0]}function a(r){return(!c(r)||0!==r.length)&&!!r}function l(r){return r[f(r)]}function r(r,n,t){var e;for(e=0;e<t.length-1;e+=2)if(a(r(t[e],n)))return r(t[e+1],n);return t.length===e+1?r(t[e],n):null}function v(r,n,t){var e=r(t,n),u=e[0],i=e[1];if(null==u||""===u)return n;var o=String(u).split("."),f=Array.isArray(o),a=0;for(o=f?o:o[Symbol.iterator]();;){var c;if(f){if(a>=o.length)break;c=o[a++]}else{if((a=o.next()).done)break;c=a.value}if(!(n=n[c]))break}return null!=n?n:null!=i?i:null}function s(r,n,t){for(var e=r(t,n),u=[],i=c(e[0])?e[0]:e,o=0;o<i.length;o++){var f=i[o],a=v(r,n,[f]);null!==a&&""!==a||u.push(f)}return u}var p,n=(void 0===(p={"+":function(r,n,t){return r(t,n).reduce((function(r,n){return parseFloat(r)+parseFloat(n)}),0)},all:function(r,n,t){var e=r(t[0],n),u=t[1];if(!e.length)return!1;for(var i=0;i<e.length;i+=1)if(!a(r(u,e[i])))return!1;return!0},and:function(r,n,t){var e,u=t,i=Array.isArray(u),o=0;for(u=i?u:u[Symbol.iterator]();;){var f;if(i){if(o>=u.length)break;f=u[o++]}else{if((o=u.next()).done)break;f=o.value}if(!a(e=r(f,n)))return e}return e},cat:function(r,n,t){return r(t,n).join("")},"/":function(r,n,t){var e=r(t,n);return e[0]/e[1]},"==":function(r,n,t){var e=r(t,n);return e[0]==e[1]},filter:function(n,r,t){var e=n(t[0],r),u=t[1];return c(e)?e.filter((function(r){return a(n(u,r))})):[]},">":function(r,n,t){var e=r(t,n),u=e[0];return e[1]<u},">=":function(r,n,t){var e=r(t,n),u=e[0];return e[1]<=u},"?:":r,if:r,in:function(r,n,t){var e=r(t,n),u=e[0],i=e[1];return!(!i||void 0===i.indexOf)&&-1!==i.indexOf(u)},"<":function(r,n,t){var e=r(t,n),u=e[0],i=e[1],o=e[2];return void 0===o?u<i:u<i&&i<o},"<=":function(r,n,t){var e=r(t,n),u=e[0],i=e[1],o=e[2];return void 0===o?u<=i:u<=i&&i<=o},log:function(r,n,t){var e=r(t,n)[0];return console.log(e),e},map:function(n,r,t){var e=n(t[0],r),u=t[1];return c(e)?e.map((function(r){return n(u,r)})):[]},max:function(r,n,t){var e=r(t,n);return Math.max.apply(Math,e)},merge:function(r,n,t){return r(t,n).reduce((function(r,n){return r.concat(n)}),[])},method:function(r,n,t){var e=r(t,n),u=e[0],i=e[1],o=e[2];return u[i].apply(u,o)},min:function(r,n,t){var e=r(t,n);return Math.min.apply(Math,e)},missing:s,missing_some:function(r,n,t){var e=r(t,n),u=e[0],i=e[1],o=s(r,n,[i]);return i.length-o.length>=u?[]:o},"%":function(r,n,t){var e=r(t,n);return e[0]%e[1]},"*":function(r,n,t){return r(t,n).reduce((function(r,n){return parseFloat(r)*parseFloat(n)}),1)},none:function(r,n,t){return 0===r({filter:t},n).length},"!":function(r,n,t){return!a(r(t,n)[0])},"!=":function(r,n,t){var e=r(t,n);return e[0]!=e[1]},"!!":function(r,n,t){return a(r(t,n)[0])},or:function(r,n,t){for(var e,u=0;u<t.length;u++)if(a(e=r(t[u],n)))return e;return e},reduce:function(t,r,n){var e=t(n[0],r),u=n[1],i=void 0!==n[2]?n[2]:null;return c(e)?e.reduce((function(r,n){return t(u,{current:n,accumulator:r})}),i):i},some:function(r,n,t){return 0<r({filter:t},n).length},"===":function(r,n,t){var e=r(t,n);return e[0]===e[1]},"!==":function(r,n,t){var e=r(t,n);return e[0]!==e[1]},substr:function(r,n,t){var e=r(t,n),u=e[0],i=e[1],o=e[2];if(o<0){var f=String(u).substr(i);return f.substr(0,f.length+o)}return String(u).substr(i,o)},"-":function(r,n,t){var e=r(t,n),u=e[0],i=e[1];return void 0===i?-u:u-i},var:v})&&(p={}),{apply:function n(r,t){if(t||(t={}),c(r))return r.map((function(r){return n(r,t)}));if(!o(r))return r;var e=f(r),u=r[e];c(u)||(u=[u]);var i=p[e];if(!i)throw new Error("Unrecognized operation "+e);return i(n,t,u)},add_operation:function n(t,u){c(t)?t.forEach((function(r){return n(r,u)})):"function"==typeof u?p[t]=function(n,t,r){var e=r.map((function(r){return n(r,t)}));return u.apply(void 0,e)}:"object"==typeof u&&Object.getOwnPropertyNames(u).forEach((function(r){n(t+"."+r,u[r])}))},rm_operation:function n(r){c(r)?r.forEach((function(r){return n(r)})):delete p[r]}});return n.is_logic=o,n.truthy=a,n.get_operator=f,n.get_values=l,n.uses_data=function n(r){var t=[];if(o(r)){var e=f(r),u=r[e];c(u)||(u=[u]),"var"===e?t.push(u[0]):u.forEach((function(r){t.push.apply(t,n(r))}))}return (function(r){for(var n=[],t=0,e=r.length;t<e;t++)-1===n.indexOf(r[t])&&n.push(r[t]);return n})(t)},n.rule_like=function r(n,t){if(t===n)return!0;if("@"===t)return!0;if("number"===t)return"number"==typeof n;if("string"===t)return"string"==typeof n;if("array"===t)return c(n)&&!o(n);if(o(t)){if(o(n)){var e=f(t),u=f(n);if("@"===e||e===u)return r(l(n),l(t))}return!1}if(c(t)){if(c(n)){if(t.length!==n.length)return!1;for(var i=0;i<t.length;i+=1)if(!r(n[i],t[i]))return!1;return!0}return!1}return!1},n}));
//# sourceMappingURL=jsonLogic.min.js.map
