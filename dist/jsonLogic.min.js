!(function(r,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):(r=r||self).jsonLogic=n()})(this,(function(){"use strict";var l=Array.isArray;function p(r){return"object"==typeof r&&null!==r&&!l(r)&&1===Object.keys(r).length}function s(r){return Object.keys(r)[0]}function a(r,n){var t=void 0===n?null:n,e=this;if(void 0===r||""===r||null===r)return e;for(var u=String(r).split("."),i=0;i<u.length;i++){if(null===e)return t;if(void 0===(e=e[u[i]]))return t}return e}function e(){for(var r=[],n=arguments.length,t=new Array(n),e=0;e<n;e++)t[e]=arguments[e];for(var u=l(t[0])?t[0]:t,i=0;i<u.length;i++){var o=u[i],f=a.call(this,o);null!==f&&""!==f||r.push(o)}return r}function r(){for(var r=arguments.length,n=new Array(r),t=0;t<r;t++)n[t]=arguments[t];return n.reduce((function(r,n){return parseFloat(r)+parseFloat(n)}),0)}function n(r,n){return r/n}function t(r,n){return r%n}function u(){for(var r=arguments.length,n=new Array(r),t=0;t<r;t++)n[t]=arguments[t];return n.reduce((function(r,n){return parseFloat(r)*parseFloat(n)}),1)}function i(r,n){return void 0===n?-r:r-n}function o(r){return(!l(r)||0!==r.length)&&!!r}function f(r,n,t){var e=r(t[0],n),u=t[1];if(!e.length)return!1;for(var i=0;i<e.length;i+=1)if(!o(r(u,e[i])))return!1;return!0}function c(n,r,t){var e=n(t[0],r),u=t[1];return l(e)?e.filter((function(r){return o(n(u,r))})):[]}function d(n,r,t){var e=n(t[0],r),u=t[1];return l(e)?e.map((function(r){return n(u,r)})):[]}function v(r,n,t){return 0===r({filter:t},n).length}function h(t,r,n){var e=t(n[0],r),u=n[1],i=void 0!==n[2]?n[2]:null;return l(e)?e.reduce((function(r,n){return t(u,{current:n,accumulator:r})}),i):i}function g(r,n,t){return 0<r({filter:t},n).length}function y(r,n,t){for(var e,u=0;u<t.length;u++)if(!o(e=r(t[u],n)))return e;return e}function m(r,n,t){var e;for(e=0;e<t.length-1;e+=2)if(o(r(t[e],n)))return r(t[e+1],n);return t.length===e+1?r(t[e],n):null}function b(r,n){return r==n}function F(r){return!o(r)}function E(r,n){return r!=n}function j(r,n,t){for(var e,u=0;u<t.length;u++)if(o(e=r(t[u],n)))return e;return e}function w(r,n){return r===n}function x(r,n){return r!==n}function O(r,n){return!(!n||void 0===n.indexOf)&&-1!==n.indexOf(r)}function _(r,n){return n<r}function A(r,n){return n<=r}function q(r,n,t){return void 0===t?r<n:r<n&&n<t}function k(r,n,t){return void 0===t?r<=n:r<=n&&n<=t}function M(r){return r[s(r)]}a.op="var",r.op="+",n.op="/",t.op="%",u.op="*",y.deepFirst=g.deepFirst=h.deepFirst=v.deepFirst=d.deepFirst=c.deepFirst=f.deepFirst=!(i.op="-"),m.op=["if","?:"],m.deepFirst=!1,b.op="==",F.op="!",E.op="!=",j.deepFirst=!(o.op="!!"),w.op="===",x.op="!==",O.op="in",_.op=">",A.op=">=",q.op="<",k.op="<=";var S,z,U=(z={},(S=Object.freeze({variable:a,missing:e,missing_some:function(r,n){var t=e.call(this,n);return n.length-t.length>=r?[]:t},add:r,divide:n,modulo:t,multiply:u,subtract:i,all:f,filter:c,map:d,merge:function(){for(var r=arguments.length,n=new Array(r),t=0;t<r;t++)n[t]=arguments[t];return n.reduce((function(r,n){return r.concat(n)}),[])},none:v,reduce:h,some:g,and:y,condition:m,equal:b,not:F,notEqual:E,notnot:o,or:j,strictEqual:w,strictNotEqual:x,indexOf:O,log:function(r){return console.log(r),r},method:function(r,n,t){return r[n].apply(r,t)},greater:_,greaterEqual:A,less:q,lessEqual:k,max:function(){return Math.max.apply(Math,arguments)},min:function(){return Math.min.apply(Math,arguments)},cat:function(){for(var r=arguments.length,n=new Array(r),t=0;t<r;t++)n[t]=arguments[t];return n.join("")},substr:function(r,n,t){if(t<0){var e=String(r).substr(n);return e.substr(0,e.length+t)}return String(r).substr(n,t)}}))&&Object.keys(S).forEach((function(r){var n=S[r];L(n.op||r,n)})),{apply:function n(r,t){if(void 0===t&&(t={}),l(r))return r.map((function(r){return n(r,t)}));if(!p(r))return r;var e,u=s(r),i=r[u];l(i)||(i=[i]);var o=z[u];if("function"==typeof o){var f=o.deepFirst;if(void 0!==f&&!f)return o(n,t,i)}if(i=i.map((function(r){return n(r,t)})),"function"==typeof o)return o.apply(t,i);if(0<u.indexOf(".")){var a=String(u).split("."),c=z;for(e=0;e<a.length;e++)if(void 0===(c=c[a[e]]))throw new Error("Unrecognized operation "+u+" (failed at "+a.slice(0,e+1).join(".")+")");return c.apply(t,i)}throw new Error("Unrecognized operation "+u)},add_operation:L,rm_operation:function n(r){l(r)?r.forEach((function(r){return n(r)})):delete z[r]}});function L(r,n){l(r)?r.forEach((function(r){return L(r,n)})):z[r]=n}return U.is_logic=p,U.truthy=o,U.get_operator=s,U.get_values=M,U.uses_data=function n(r){var t=[];if(p(r)){var e=s(r),u=r[e];l(u)||(u=[u]),"var"===e?t.push(u[0]):u.forEach((function(r){t.push.apply(t,n(r))}))}return (function(r){for(var n=[],t=0,e=r.length;t<e;t++)-1===n.indexOf(r[t])&&n.push(r[t]);return n})(t)},U.rule_like=function r(n,t){if(t===n)return!0;if("@"===t)return!0;if("number"===t)return"number"==typeof n;if("string"===t)return"string"==typeof n;if("array"===t)return l(n)&&!p(n);if(p(t)){if(p(n)){var e=s(t),u=s(n);if("@"===e||e===u)return r(M(n),M(t))}return!1}if(l(t)){if(l(n)){if(t.length!==n.length)return!1;for(var i=0;i<t.length;i+=1)if(!r(n[i],t[i]))return!1;return!0}return!1}return!1},U}));
//# sourceMappingURL=jsonLogic.min.js.map
