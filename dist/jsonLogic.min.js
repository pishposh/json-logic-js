!(function(r,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):(r=r||self).jsonLogic=n()})(this,(function(){"use strict";var l=Array.isArray;function p(r){return"object"==typeof r&&null!==r&&!l(r)&&1===Object.keys(r).length}function s(r){return Object.keys(r)[0]}function r(r,n){var t=void 0===n?null:n,e=this;if(void 0===r||""===r||null===r)return e;for(var u=String(r).split("."),i=0;i<u.length;i++){if(null===e)return t;if(void 0===(e=e[u[i]]))return t}return e}function n(r){for(var n=[],t=arguments.length,e=new Array(1<t?t-1:0),u=1;u<t;u++)e[u-1]=arguments[u];for(var i=l(e[0])?e[0]:e,o=0;o<i.length;o++){var f=i[o],a=r({var:f},this);null!==a&&""!==a||n.push(f)}return n}function t(r,n,t){var e=r({missing:t},this);return t.length-e.length>=n?[]:e}function e(){for(var r=arguments.length,n=new Array(r),t=0;t<r;t++)n[t]=arguments[t];return n.reduce((function(r,n){return parseFloat(r)+parseFloat(n)}),0)}function u(r,n){return r/n}function i(r,n){return r%n}function o(){for(var r=arguments.length,n=new Array(r),t=0;t<r;t++)n[t]=arguments[t];return n.reduce((function(r,n){return parseFloat(r)*parseFloat(n)}),1)}function f(r,n){return void 0===n?-r:r-n}function a(r){return(!l(r)||0!==r.length)&&!!r}function c(r,n,t){var e=r(t[0],n),u=t[1];if(!e.length)return!1;for(var i=0;i<e.length;i+=1)if(!a(r(u,e[i])))return!1;return!0}function d(n,r,t){var e=n(t[0],r),u=t[1];return l(e)?e.filter((function(r){return a(n(u,r))})):[]}function h(n,r,t){var e=n(t[0],r),u=t[1];return l(e)?e.map((function(r){return n(u,r)})):[]}function v(r,n,t){return 0===r({filter:t},n).length}function g(t,r,n){var e=t(n[0],r),u=n[1],i=void 0!==n[2]?n[2]:null;return l(e)?e.reduce((function(r,n){return t(u,{current:n,accumulator:r})}),i):i}function y(r,n,t){return 0<r({filter:t},n).length}function m(r,n,t){for(var e,u=0;u<t.length;u++)if(!a(e=r(t[u],n)))return e;return e}function b(r,n,t){var e;for(e=0;e<t.length-1;e+=2)if(a(r(t[e],n)))return r(t[e+1],n);return t.length===e+1?r(t[e],n):null}function F(r,n){return r==n}function w(r){return!a(r)}function E(r,n){return r!=n}function A(r,n,t){for(var e,u=0;u<t.length;u++)if(a(e=r(t[u],n)))return e;return e}function j(r,n){return r===n}function x(r,n){return r!==n}function O(r,n){return!(!n||void 0===n.indexOf)&&-1!==n.indexOf(r)}function _(r,n){return n<r}function q(r,n){return n<=r}function k(r,n,t){return void 0===t?r<n:r<n&&n<t}function M(r,n,t){return void 0===t?r<=n:r<=n&&n<=t}function S(r){return r[s(r)]}r.op="var",t.withApply=n.withApply=!0,e.op="+",u.op="/",i.op="%",o.op="*",m.deepFirst=y.deepFirst=g.deepFirst=v.deepFirst=h.deepFirst=d.deepFirst=c.deepFirst=!(f.op="-"),b.op=["if","?:"],b.deepFirst=!1,F.op="==",w.op="!",E.op="!=",A.deepFirst=!(a.op="!!"),j.op="===",x.op="!==",O.op="in",_.op=">",q.op=">=",k.op="<",M.op="<=";var z,U,L=(U={},(z=Object.freeze({variable:r,missing:n,missing_some:t,add:e,divide:u,modulo:i,multiply:o,subtract:f,all:c,filter:d,map:h,merge:function(){for(var r=arguments.length,n=new Array(r),t=0;t<r;t++)n[t]=arguments[t];return n.reduce((function(r,n){return r.concat(n)}),[])},none:v,reduce:g,some:y,and:m,condition:b,equal:F,not:w,notEqual:E,notnot:a,or:A,strictEqual:j,strictNotEqual:x,indexOf:O,log:function(r){return console.log(r),r},method:function(r,n,t){return r[n].apply(r,t)},greater:_,greaterEqual:q,less:k,lessEqual:M,max:function(){return Math.max.apply(Math,arguments)},min:function(){return Math.min.apply(Math,arguments)},cat:function(){for(var r=arguments.length,n=new Array(r),t=0;t<r;t++)n[t]=arguments[t];return n.join("")},substr:function(r,n,t){if(t<0){var e=String(r).substr(n);return e.substr(0,e.length+t)}return String(r).substr(n,t)}}))&&Object.keys(z).forEach((function(r){var n=z[r];N(n.op||r,n)})),{apply:function n(r,t){if(void 0===t&&(t={}),l(r))return r.map((function(r){return n(r,t)}));if(!p(r))return r;var e,u=s(r),i=r[u];l(i)||(i=[i]);var o=U[u];if("function"==typeof o){var f=o.deepFirst;if(void 0!==f&&!f)return o(n,t,i)}if(i=i.map((function(r){return n(r,t)})),"function"==typeof o)return o.withApply&&i.unshift(n),o.apply(t,i);if(0<u.indexOf(".")){var a=String(u).split("."),c=U;for(e=0;e<a.length;e++)if(void 0===(c=c[a[e]]))throw new Error("Unrecognized operation "+u+" (failed at "+a.slice(0,e+1).join(".")+")");return c.apply(t,i)}throw new Error("Unrecognized operation "+u)},add_operation:N,rm_operation:function n(r){l(r)?r.forEach((function(r){return n(r)})):delete U[r]}});function N(r,n){l(r)?r.forEach((function(r){return N(r,n)})):U[r]=n}return L.is_logic=p,L.truthy=a,L.get_operator=s,L.get_values=S,L.uses_data=function n(r){var t=[];if(p(r)){var e=s(r),u=r[e];l(u)||(u=[u]),"var"===e?t.push(u[0]):u.forEach((function(r){t.push.apply(t,n(r))}))}return (function(r){for(var n=[],t=0,e=r.length;t<e;t++)-1===n.indexOf(r[t])&&n.push(r[t]);return n})(t)},L.rule_like=function r(n,t){if(t===n)return!0;if("@"===t)return!0;if("number"===t)return"number"==typeof n;if("string"===t)return"string"==typeof n;if("array"===t)return l(n)&&!p(n);if(p(t)){if(p(n)){var e=s(t),u=s(n);if("@"===e||e===u)return r(S(n),S(t))}return!1}if(l(t)){if(l(n)){if(t.length!==n.length)return!1;for(var i=0;i<t.length;i+=1)if(!r(n[i],t[i]))return!1;return!0}return!1}return!1},L}));
//# sourceMappingURL=jsonLogic.min.js.map
