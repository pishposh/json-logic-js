!(function(r,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):(r=r||self).jsonLogic=n()})(this,(function(){"use strict";var r=Array.isArray;function n(n){return"object"==typeof n&&null!==n&&!r(n)&&1===Object.keys(n).length}function t(r){return Object.keys(r)[0]}function e(n){return(!r(n)||0!==n.length)&&!!n}function u(r){return r[t(r)]}var i,o=function(r,n,t){var u;for(u=0;u<t.length-1;u+=2)if(e(r(t[u],n)))return r(t[u+1],n);return t.length===u+1?r(t[u],n):null},f=function(r,n,t){var e=r(t,n),u=e[0],i=e[1];if(null==u||""===u)return n;var o=String(u).split("."),f=Array.isArray(o),a=0;for(o=f?o:o[Symbol.iterator]();;){var c;if(f){if(a>=o.length)break;c=o[a++]}else{if((a=o.next()).done)break;c=a.value}if(!(n=n[c]))break}return null!=n?n:null!=i?i:null},a=function(n,t,e){for(var u=n(e,t),i=[],o=r(u[0])?u[0]:u,a=0;a<o.length;a++){var c=o[a],l=f(n,t,[c]);null!==l&&""!==l||i.push(c)}return i},c=(void 0===(i={"+":function(r,n,t){return r(t,n).reduce((function(r,n){return parseFloat(r)+parseFloat(n)}),0)},all:function(r,n,t){var u=r(t[0],n),i=t[1];if(!u.length)return!1;for(var o=0;o<u.length;o+=1)if(!e(r(i,u[o])))return!1;return!0},and:function(r,n,t){var u,i=t,o=Array.isArray(i),f=0;for(i=o?i:i[Symbol.iterator]();;){var a;if(o){if(f>=i.length)break;a=i[f++]}else{if((f=i.next()).done)break;a=f.value}if(!e(u=r(a,n)))return u}return u},cat:function(r,n,t){return r(t,n).join("")},"/":function(r,n,t){var e=r(t,n);return e[0]/e[1]},"==":function(r,n,t){var e=r(t,n);return e[0]==e[1]},filter:function(n,t,u){var i=n(u[0],t),o=u[1];return r(i)?i.filter((function(r){return e(n(o,r))})):[]},">":function(r,n,t){var e=r(t,n);return e[0]>e[1]},">=":function(r,n,t){var e=r(t,n);return e[0]>=e[1]},"?:":o,if:o,in:function(r,n,t){var e=r(t,n),u=e[0],i=e[1];return!(!i||void 0===i.indexOf)&&-1!==i.indexOf(u)},"<":function(r,n,t){var e=r(t,n),u=e[0],i=e[1],o=e[2];return void 0===o?u<i:u<i&&i<o},"<=":function(r,n,t){var e=r(t,n),u=e[0],i=e[1],o=e[2];return void 0===o?u<=i:u<=i&&i<=o},log:function(r,n,t){var e=r(t,n)[0];return console.log(e),e},map:function(n,t,e){var u=n(e[0],t),i=e[1];return r(u)?u.map((function(r){return n(i,r)})):[]},max:function(r,n,t){var e=r(t,n);return Math.max.apply(Math,e)},merge:function(r,n,t){return r(t,n).reduce((function(r,n){return r.concat(n)}),[])},method:function(r,n,t){var e=r(t,n),u=e[0],i=e[1],o=e[2];return u[i].apply(u,o)},min:function(r,n,t){var e=r(t,n);return Math.min.apply(Math,e)},missing:a,missing_some:function(r,n,t){var e=r(t,n),u=e[0],i=e[1],o=a(r,n,[i]);return i.length-o.length>=u?[]:o},"%":function(r,n,t){var e=r(t,n);return e[0]%e[1]},"*":function(r,n,t){return r(t,n).reduce((function(r,n){return parseFloat(r)*parseFloat(n)}),1)},none:function(r,n,t){return 0===r({filter:t},n).length},"!":function(r,n,t){return!e(r(t,n)[0])},"!=":function(r,n,t){var e=r(t,n);return e[0]!=e[1]},"!!":function(r,n,t){return e(r(t,n)[0])},or:function(r,n,t){for(var u,i=0;i<t.length;i++)if(e(u=r(t[i],n)))return u;return u},reduce:function(n,t,e){var u=n(e[0],t),i=e[1],o=void 0!==e[2]?e[2]:null;return r(u)?u.reduce((function(r,t){return n(i,{current:t,accumulator:r})}),o):o},some:function(r,n,t){return r({filter:t},n).length>0},"===":function(r,n,t){var e=r(t,n);return e[0]===e[1]},"!==":function(r,n,t){var e=r(t,n);return e[0]!==e[1]},substr:function(r,n,t){var e=r(t,n),u=e[0],i=e[1],o=e[2];if(o<0){var f=String(u).substr(i);return f.substr(0,f.length+o)}return String(u).substr(i,o)},"-":function(r,n,t){var e=r(t,n),u=e[0],i=e[1];return void 0===i?-u:u-i},var:f})&&(i={}),{apply:function e(u,o){if(o||(o={}),r(u))return u.map((function(r){return e(r,o)}));if(!n(u))return u;var f=t(u),a=u[f];r(a)||(a=[a]);var c=i[f];if(!c)throw new Error("Unrecognized operation "+f);return c(e,o,a)},add_operation:function n(t,e){r(t)?t.forEach((function(r){return n(r,e)})):"function"==typeof e?i[t]=function(r,n,t){var u=t.map((function(t){return r(t,n)}));return e.apply(void 0,u)}:"object"==typeof e&&Object.getOwnPropertyNames(e).forEach((function(r){n(t+"."+r,e[r])}))},rm_operation:function n(t){r(t)?t.forEach((function(r){return n(r)})):delete i[t]}});return c.is_logic=n,c.truthy=e,c.get_operator=t,c.get_values=u,c.uses_data=function e(u){var i=[];if(n(u)){var o=t(u),f=u[o];r(f)||(f=[f]),"var"===o?i.push(f[0]):f.forEach((function(r){i.push.apply(i,e(r))}))}return (function(r){for(var n=[],t=0,e=r.length;t<e;t++)-1===n.indexOf(r[t])&&n.push(r[t]);return n})(i)},c.rule_like=function e(i,o){if(o===i)return!0;if("@"===o)return!0;if("number"===o)return"number"==typeof i;if("string"===o)return"string"==typeof i;if("array"===o)return r(i)&&!n(i);if(n(o)){if(n(i)){var f=t(o),a=t(i);if("@"===f||f===a)return e(u(i),u(o))}return!1}if(r(o)){if(r(i)){if(o.length!==i.length)return!1;for(var c=0;c<o.length;c+=1)if(!e(i[c],o[c]))return!1;return!0}return!1}return!1},c}));
//# sourceMappingURL=jsonLogic.min.js.map
